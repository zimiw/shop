<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>洋流网</title>

        <link rel="stylesheet" href="../css/front/reset.css" />
        <link rel="stylesheet" href="../css/front/vendor/jquery.idcode.css" />
        <link rel="stylesheet" href="../css/front/forget.css" />
    </head>
    <body ms-controller="common">
        <div ms-include-src="'../template/header.html'" data-include-replace="true" data-include-loaded="initHeader"></div>
        <div class="wrap" ms-controller="forget">
            <div class="topbar-box">
                <div class="topbar" ms-class="step{{step}}"></div>
            </div>
            <div class="forget-box">
                <div class="step1" ms-visible="step == 1">
                    <div class="item">
                        <label>用户名：</label>
                        <input class="yl-ipt" type="text" ms-duplex="name" />
                    </div>
                    <div class="item validate">
                        <label>验证码：</label>
                        <input class="yl-ipt code" id="loginIdcodeTxt" />
                        <span class="validate-code" id="loginIdcode"></span>
                        <!--<p class="change">换一张</p>-->
                        <p class="err-tip" ms-visible="errCode">验证码输入错误</p>
                    </div>
                    <div class="item">
                        <label></label>
                        <button class="btn-next" ms-click="next(2)">下一步</button>
                    </div>
                </div>
                <div class="step2" ms-visible="step == 2">
                    <div class="item">
                        <label>请选择验证身份方式：</label>
                        <select class="yl-select">
                            <option>已验证手机</option>
                            <option>邮箱</option>
                        </select>
                    </div>
                    <div class="item">
                        <label>昵称：</label>
                        <p class="ctt"></p>
                    </div>
                    <div class="item">
                        <label>手机号码：</label>
                        <p class="ctt"></p>
                    </div>
                    <div class="item">
                        <label>请填写手机校验码：</label>
                        <input class="yl-ipt code" type="text" />
                        <button class="btn-phone">获取短信验证码</button>
                    </div>
                    <div class="item">
                        <label></label>
                        <button class="btn-next" ms-click="next(3)">下一步</button>
                    </div>
                </div>
                <div class="step3" ms-visible="step == 3">
                    <div class="item">
                        <label>输入新密码：</label>
                        <input class="yl-ipt" type="text" />
                    </div>
                    <div class="item">
                        <label>重复新密码：</label>
                        <input class="yl-ipt" type="text" />
                    </div>
                    <div class="item">
                        <label></label>
                        <button class="btn-next" ms-click="next(4)">下一步</button>
                    </div>
                </div>
                <div class="step4" ms-visible="step == 4">
                    <p class="modify-tip success" ms-visible="modifyFlag">恭喜您，密码修改成功！</p>
                    <p class="modify-tip fail" ms-visible="!modifyFlag">很抱歉，密码修改失败！</p>
                </div>
            </div>
        </div>
        <div ms-include-src="'../template/footer.html'" data-include-replace="true"></div>

        <script src="../js/avalon.shim.sn.js"></script>
        <script src="../js/jquery.min.js"></script>
        <script src="../js/vendor/jquery.idcode.js"></script>
        <script src="../js/main.js"></script>
        <script src="../js/data-interface.js"></script>
        <script>
            $(function(){
                var forgetCtrl = avalon.define({
                    $id: "forget",
                    step: 2,
                    name: "",
                    errCode: false,
                    modifyFlag: true,
                    next: function(step){
                        if(step == 2){
                            if(forgetCtrl.name != ""){
                                if($.idcode.validateCode()){
                                    forgetCtrl.errCode = false;
                                    forgetCtrl.step = step;
                                }else{
                                    forgetCtrl.errCode = true;
                                }
                            }
                        }
                    }
                });

                avalon.scan();
                
                $.idcode.setCode({
                    e: "loginIdcode",
                    codeType: {name: "follow", len: 4},
                    codeTip: "",
                    inputID: "loginIdcodeTxt"
                });
            });
        </script>
    </body>
</html>
